import{g as a,s as n}from"./utility-Q-9IHOGv.js";async function s(){try{const o=await c("proxy_auth_token");await n("proxy_auth_token",o)}catch(o){console.error("Error getting token from local storage: ",o)}}async function c(){return new Promise((o,r)=>{chrome.cookies.get({url:"https://chat.50agents.com",name:"proxy_auth_token"},function(e){chrome.runtime.lastError?(console.error(chrome.runtime.lastError),r(chrome.runtime.lastError)):o(e==null?void 0:e.value)})})}async function i(){await a("proxy_auth_token")||(console.log("No token found in local storage"),s())}chrome.runtime.onInstalled.addListener(()=>{console.log("Extension Installed!!"),i()});chrome.runtime.onMessage.addListener(function(o,r,e){console.log(r.tab?"from a content script:"+r.tab.url:"from the extension");try{switch(o.type){case"get-token":c("proxy_auth_token").then(t=>{e({token:t||null})}).catch(t=>{e({error:t})});break;case"get-storage":chrome.storage.local.get(o.keys,t=>{e(t)});break;default:e({error:"Invalid request"})}}catch(t){console.error("Error handling message:",t),e({error:"Internal error"})}return!0});chrome.cookies.onChanged.addListener(async function(o){if(o.cookie.domain.includes("chat.50agents.com")&&o.cookie.name==="proxy_auth_token"&&o.removed===!1&&!await a("proxy_auth_token")){await n("proxy_auth_token",o.cookie.value);const r=await chrome.tabs.query({url:"*://meet.google.com/*"});for(const e of r)chrome.tabs.sendMessage(e.id,{type:"REFRESH_PAGE"})}});
